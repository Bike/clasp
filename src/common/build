#! /bin/bash -f
#
# grovel project directories for symbols and classes
#
(export PYTHONPATH=$CLASP_HOME/src/common:$PYTHONPATH; $PYTHON2 $CLASP_HOME/src/common/classGroveler.py include/generated/initClasses_inc.h `cat ../../src/main/project-directories.config` 2>registerClasses.log)

#
# Run the new SBCL scraper
# currently it needs the files generated above by the python grovelers
#
install -d bin
bjam $* -n -a >bin/all-commands.txt
bjam $* -n >bin/commands.txt
<<<<<<< HEAD
echo Running $CLASP_SBCL --load $CLASP_HOME/src/scraper/scraper.lisp -- $CLASP_CLANG_PATH `pwd`/ bin/all-commands.txt bin/commands.txt
$CLASP_SBCL --load $CLASP_HOME/src/scraper/scraper.lisp -- $CLASP_CLANG_PATH `pwd`/ bin/all-commands.txt bin/commands.txt
=======
echo Running $CLASP_SBCL  --dynamic-space-size 4096 --load $CLASP_HOME/src/scraper/scraper.lisp -- `$LLVM_CONFIG_RELEASE --bindir`/clang `pwd`/ `pwd`/include/application.config bin/all-commands.txt bin/commands.txt
$CLASP_SBCL --dynamic-space-size 4096 --load $CLASP_HOME/src/scraper/scraper.lisp -- `$LLVM_CONFIG_RELEASE --bindir`/clang `pwd`/ `pwd`/include/application.config bin/all-commands.txt bin/commands.txt
>>>>>>> 76793d0a72fb886100334320847c45c6036ff5e1

#
# run bjam to build app
#
echo bjam $*
bjam $*
